							----Assignment 2 of Mysql basics----
										-Arijit Acharya
1)Code for creating the 3 tables.

 //Creating the employee_code _table.
	CREATE TABLE employee_code_table(  
	  employee_code VARCHAR(255) PRIMARY KEY ,
	  employee_code_name VARCHAR(255),
	  employee_domain VARCHAR(255)
	);
	
 //Creating the employee_salary_table.
	CREATE TABLE employee_details_table(
  	employee_id VARCHAR(255) PRIMARY KEY,
  	employee_salary VARCHAR(255),
  	employee_code VARCHAR(255) ,
  	FOREIGN KEY (employee_code) REFERENCES employee_code_table (employee_code)
	);
	
	//By mistakenly written the table name wrong so renamed it to correct table name
	ALTER TABLE employee_details_table RENAME employee_salary_table;
 
 //Creating the employee_detail_table.	
	CREATE TABLE employee_details_table(
	  employee_id VARCHAR(255) PRIMARY KEY,
	  employee_first_name VARCHAR(255),
	  employee_last_name VARCHAR(255),
	  Graduation_percentile DECIMAL(5,2)
	);
	
2) Inserting the values into 3 tables.

 //Inserting values into employee_code_table.
	
	INSERT INTO employee_code_table
	VALUES
	("su_john","ru_john","Java"),
	("su_daenerys","du_daenerys","PHP"),
	("su_cersei","ru_cersei","Java"),
	("su_tyrion","tu_tyrion","Angular JS");
	
 //Inserting values into employee_salary_table.
 
	INSERT INTO employee_salary_table
	VALUES
	("RU122","60k","su_john"),
	("RU123","25k","su_daenerys"),
	("RU124","44k","su_cersei"),
	("RU125","85k","su_tyrion");	
		
 //Inserting values into employee_details_table.	
 
	INSERT INTO employee_details_table
	VALUES
	("RU122","John","Snow",60),
	("RU123","Daenerys","Targaryen",88),
	("RU124","Cersei","Lannister",72),
	("RU125","Tyrion","Lannister",64);
	
	
3) Solution of the queries.
	
	a)WAQ to list all employee first name with salary greater than 50k. 
	
	ANS =>
			SELECT employee_first_name 
			FROM employee_details_table 
			WHERE employee_id IN (SELECT employee_id FROM employee_salary_table WHERE employee_salary > '50k');
	
	
	b)WAQ to list all employee last name with graduation percentile greater than 70%. 
	
	ANS=>	
			SELECT employee_last_name
			FROM employee_details_table 
			WHERE Graduation_percentile >70;
			
	c)WAQ to list all employee code name with graduation percentile less than 70%. 
	
	ANS=>
			SELECT employee_code_name 
			FROM employee_code_table 
			WHERE employee_code IN (SELECT employee_code 
			FROM employee_salary_table 
			WHERE employee_id IN (SELECT employee_id 
			FROM employee_details_table 
			WHERE Graduation_percentile <70));
			
	d)WAQ to list all employeeâ€™s full name that are not of domain Java. 
	
	ANS=>
			SELECT employee_first_name,employee_last_name 
			FROM employee_details_table 
			WHERE employee_id = ANY (SELECT employee_id 
			FROM employee_salary_table 
			where employee_code = ANY(SELECT employee_code 
			FROM employee_code_table 
			WHERE employee_domain <> "JAVA"));
			
	e)WAQ to list all employee_domain with sum of it's salary. 
	
	ANS=>
			SELECT sum(employee_salary ),employee_domain
			FROM employee_salary_table
			CROSS JOIN employee_code_table
			WHERE employee_salary_table.employee_code = employee_code_table.employee_code 
			GROUP BY employee_code_table.employee_domain;

	f)Write the above query again but dont include salaries which is less than 30k. 
	
	ANS=> 	
						
			SELECT sum(employee_salary ),employee_domain
			FROM employee_salary_table
			CROSS JOIN employee_code_table
			WHERE employee_salary_table.employee_code = employee_code_table.employee_code 
			AND employee_salary_table.employee_salary > 30
			GROUP BY employee_code_table.employee_domain;
				
	g)WAQ to list all employee id which has not been assigned employee code. 
	
	ANS=>
			SELECT employee_id 
			FROM employee_salary_table 
			WHERE employee_code IS NULL;

	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
